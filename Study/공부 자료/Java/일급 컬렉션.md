# 일급 컬렉션(First-class Collection)

## 1. 서론(개요)
일급 컬렉션은 컬렉션(List, Set, Map 등)을 하나의 객체로 감싸서, 외부에서 직접 컬렉션을 다루지 않도록 만드는 객체지향 설계 패턴이다.  
캡슐화와 불변성, 비즈니스 로직 응집이라는 장점을 통해 코드의 품질과 안전성을 크게 높일 수 있다.

## 2. 주요 개념

- **컬렉션을 직접 노출하지 않음**  
  필드가 단 하나의 컬렉션(List, Set, Map 등)만 가지도록 하고, 직접 수정하거나 접근하는 메서드를 최대한 제한한다.

- **불변성 보장**  
  컬렉션을 외부에서 변경할 수 없도록 생성자에서 복사(Deep Copy) 또는 `Collections.unmodifiableList` 등으로 감싼다.

- **비즈니스 로직 응집**  
  검증, 조회, 계산, 추가/삭제 등 컬렉션에 대한 로직을 이 클래스 안에 응집시켜, 도메인 의미를 명확하게 전달함.

- **도메인 언어에 맞는 클래스 이름 사용**  
  단순한 List, Set이 아닌, 의미 있는 도메인 네이밍(Orders, UserGroups 등)을 부여한다.

## 3. 코드 예제 (Java/Spring 기반)

```java
// 주문 목록을 감싸는 일급 컬렉션 예시
public class Orders {
    private final List<Order> orders;

    public Orders(List<Order> orders) {
        this.orders = Collections.unmodifiableList(new ArrayList<>(orders)); // 불변성
    }

    // 컬렉션 관련 비즈니스 로직 응집
    public int totalPrice() {
        return orders.stream().mapToInt(Order::getPrice).sum();
    }

    public boolean isEmpty() {
        return orders.isEmpty();
    }

    public List<Order> getOrders() {
        return orders; // 불변이므로 노출 가능
    }
}
```

## 4. 장점

- **캡슐화(Encapsulation):**  
  컬렉션 수정·접근을 통제하여, 예기치 않은 변경 혹은 데이터 오염을 막을 수 있음.

- **불변성(Immutability):**  
  실수/동시성 문제 감소 및 안전한 데이터 사용 보장.

- **비즈니스 규칙 응집:**  
  컬렉션 관련 로직을 한 곳에 몰아 유지보수와 테스트가 쉬워짐.

- **도메인 주도 설계(DDD)와 잘 어울림:**  
  의미 있는 도메인 객체를 명확히 표현 가능.

## 5. 유의점 및 실무 트렌드

- 과도하게 남용 시, 코드가 지나치게 복잡해질 수 있음(비즈니스 가치가 있는 컬렉션에만 적용 권장).
- Java/Spring 실무에서는 **DTO, 엔티티의 컬렉션 필드, 도메인 값 객체(Value Object)**에 자주 활용.
- JPA와 결합 시, 불변 컬렉션의 사용이 엔티티 상태 관리(Dirty Checking)와 관련되어 주의가 필요함.
- 스프링에서는 Validation, 요청·응답 객체(DTO) 구분 등에 일급 컬렉션 패턴이 자주 사용됨.

## 6. 참고자료

- [우아한형제들 기술블로그: 일급 컬렉션 사용하는 법](https://techblog.woowahan.com/2597/)
- [Spring 공식 문서 - Bean Validation](https://docs.spring.io/spring-framework/reference/core/validation/beanvalidation.html)
- [DDD Start! 1권 - 일급 컬렉션 관련 예제](https://book.naver.com/bookdb/book_detail.nhn?bid=9516257)

